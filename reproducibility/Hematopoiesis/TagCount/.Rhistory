library(ggplot2)
df <- read.table("TagCount.txt", header = TRUE)
df_binary <- df
df_binary[df_binary>1] <- 1
df <- df[, colSums(df_binary) > 1000]
df_binary <- df
df_binary[df_binary>1] <- 1
nrow(df)
df2 <- df[rowSums(df_binary) > 0.01 * ncol(df), ]
df2 <- df[rowSums(df_binary) > 0.05 * ncol(df), ]
df2 <- df[rowSums(df_binary) > 0.01 * ncol(df), ]
df2 <- df[rowSums(df_binary) > 0.001 * ncol(df), ]
df2 <- df[rowSums(df_binary) > 0.005 * ncol(df), ]
df2 <- df[rowSums(df_binary) > 0.01 * ncol(df), ]
rownames(df2)
peaks <- read.table("../Imputation/BNMF/peaks.bed", header = TRUE)
peaks <- read.table("../Imputation/BNMF/peaks.txt", header = TRUE)
colnames(peaks)
peaks <- read.table("../Imputation/BNMF/peaks.txt", header = FALSE)
colnames(peaks)
df2 <- df[peaks$V1, ]
write.table(df2, file = "TagCount_filter.txt", quote = FALSE, sep = "\t")
library(ggplot2)
df <- read.table("TagCount.txt", header = TRUE)
df2 <- read.table("../Imputation/BNMF/BNMF.txt", header = TRUE)
peaks <- rownames(df2)
cells <- colnames(df2)
rm(df2)
df3 <- df[peaks, cells]
write.table(df3, file = "TagCount_filter.txt", quote = FALSE, sep = "\t")
