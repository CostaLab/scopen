library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA', 'scOpen_SpecificDropout',
'scOpen_NonSpecificDropout')
df_list <- vector(mode = "list", length = length(method_list))
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
scale_fill_brewer(palette = "Paired") +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
orders <- levels(with(df, reorder(Method, -AUPR, FUN = mean)))
df.test <- df %>% spread(Method, AUPR)
df.test$Runs <- NULL
df.test$CellType <- NULL
rownames(df.test) <- 1:nrow(df.test)
df.test <- df.test[, orders]
df.test <- as.matrix(df.test)
test.res <- frdAllPairsNemenyiTest(df.test, p.adjust.methods = "BH")
write.xlsx(as.data.frame(test.res$p.value), 'pvalues.xlsx', colNames = TRUE,
rowNames = TRUE)
