print(pr$auc.integral)
for(colname in colnames(df)[1:10]){
celltype <- stringr::str_split_fixed(colname, "_", 2)[, 1]
scores.class0 <- df[[colname]][df_true[[celltype]] == 0]
scores.class1 <- df[[colname]][df_true[[celltype]] == 1]
pr <- pr.curve(scores.class0 = scores.class0,
scores.class1 = scores.class1,
curve = TRUE)
print(pr$auc.integral)
}
celltype
colnamedf_true
colnames(df_true)
df_auc <- setNames(data.frame(matrix(ncol = ncol(df_true), nrow = 0)),
colnames(df_true))
View(df_auc)
df_auc <- setNames(data.frame(matrix(ncol = ncol(df_true), nrow = 200)),
colnames(df_true))
View(df_auc)
idx <- as.integer(stringr::str_split_fixed(colname, "_", 2)[, 2])
df_auc[[celltype]][[idx]] <- pr$auc.integral
View(df_auc)
df_auc <- setNames(data.frame(matrix(ncol = ncol(df_true), nrow = 200)),
colnames(df_true))
for(colname in colnames(df)[1:10]){
celltype <- stringr::str_split_fixed(colname, "_", 2)[, 1]
idx <- as.integer(stringr::str_split_fixed(colname, "_", 2)[, 2])
scores.class0 <- df[[colname]][df_true[[celltype]] == 0]
scores.class1 <- df[[colname]][df_true[[celltype]] == 1]
pr <- pr.curve(scores.class0 = scores.class0,
scores.class1 = scores.class1,
curve = TRUE)
df_auc[[celltype]][[idx]] <- pr$auc.integral
}
View(df_auc)
for(colname in colnames(df)){
celltype <- stringr::str_split_fixed(colname, "_", 2)[, 1]
idx <- as.integer(stringr::str_split_fixed(colname, "_", 2)[, 2])
scores.class0 <- df[[colname]][df_true[[celltype]] == 0]
scores.class1 <- df[[colname]][df_true[[celltype]] == 1]
pr <- pr.curve(scores.class0 = scores.class0,
scores.class1 = scores.class1,
curve = TRUE)
df_auc[[celltype]][[idx]] <- pr$auc.integral
}
View(df_auc)
colnames(df_score)
colnames(df)
201 / 200
201 %% 200
199 %% 200
for(colname in colnames(df_score)){
celltype <- stringr::str_split_fixed(colname, "_", 2)[, 1]
idx <- as.integer(stringr::str_split_fixed(colname, "_", 2)[, 2]) %% 200
scores.class0 <- df_score[[colname]][df_true[[celltype]] == 0]
scores.class1 <- df_score[[colname]][df_true[[celltype]] == 1]
pr <- pr.curve(scores.class0 = scores.class0,
scores.class1 = scores.class1,
curve = TRUE)
df_auc[[celltype]][[idx]] <- pr$auc.integral
}
df_score <- df
for(colname in colnames(df_score)){
celltype <- stringr::str_split_fixed(colname, "_", 2)[, 1]
idx <- as.integer(stringr::str_split_fixed(colname, "_", 2)[, 2]) %% 200
scores.class0 <- df_score[[colname]][df_true[[celltype]] == 0]
scores.class1 <- df_score[[colname]][df_true[[celltype]] == 1]
pr <- pr.curve(scores.class0 = scores.class0,
scores.class1 = scores.class1,
curve = TRUE)
df_auc[[celltype]][[idx]] <- pr$auc.integral
}
pr$auc.integral
View(df_auc)
200 %% 200
for(colname in colnames(df_score)){
celltype <- stringr::str_split_fixed(colname, "_", 2)[, 1]
scores.class0 <- df_score[[colname]][df_true[[celltype]] == 0]
scores.class1 <- df_score[[colname]][df_true[[celltype]] == 1]
pr <- pr.curve(scores.class0 = scores.class0,
scores.class1 = scores.class1,
curve = TRUE)
idx <- as.integer(stringr::str_split_fixed(colname, "_", 2)[, 2])
if(idx %% 200 == 0){
idx <- idx %% 200 + 1
} else{
idx <- idx %% 200
}
df_auc[[celltype]][[idx]] <- pr$auc.integral
}
View(df_auc)
colnamedf
colnames(df_score)
df_score[["CMP_1000"]]
colname <- "CMP_1000"
celltype <- stringr::str_split_fixed(colname, "_", 2)[, 1]
scores.class0 <- df_score[[colname]][df_true[[celltype]] == 0]
scores.class1 <- df_score[[colname]][df_true[[celltype]] == 1]
pr <- pr.curve(scores.class0 = scores.class0,
scores.class1 = scores.class1,
curve = TRUE)
pr$auc.integral
idx <- as.integer(stringr::str_split_fixed(colname, "_", 2)[, 2])
if(idx %% 200 == 0){
idx <- idx %% 200 + 1
} else{
idx <- idx %% 200
}
colnames(df_score)
801 %% 200
999 %200%
1
999 %% 200
df_auc <- NA
df_auc <- setNames(data.frame(matrix(ncol = ncol(df_true), nrow = 200)),
colnames(df_true))
View(df_auc)
for(colname in colnames(df_score)){
celltype <- stringr::str_split_fixed(colname, "_", 2)[, 1]
scores.class0 <- df_score[[colname]][df_true[[celltype]] == 0]
scores.class1 <- df_score[[colname]][df_true[[celltype]] == 1]
pr <- pr.curve(scores.class0 = scores.class0,
scores.class1 = scores.class1,
curve = TRUE)
idx <- as.integer(stringr::str_split_fixed(colname, "_", 2)[, 2])
if(idx > 200){
if(idx %% 200 == 0){
idx <- 200
} else{
idx <- idx %% 200
}
}
df_auc[[celltype]][[idx]] <- pr$auc.integral
}
View(df_auc)
for(colname in colnames(df_score)){
celltype <- stringr::str_split_fixed(colname, "_", 2)[, 1]
pr <- pr.curve(scores.class0 = df_score[[colname]][df_true[[celltype]] == 0],
scores.class1 = df_score[[colname]][df_true[[celltype]] == 1],
curve = FALSE)
idx <- as.integer(stringr::str_split_fixed(colname, "_", 2)[, 2])
if(idx > 200){
if(idx %% 200 == 0){
idx <- 200
} else{
idx <- idx %% 200
}
}
df_auc[[celltype]][[idx]] <- pr$auc.integral
}
View(df_auc)
for(colname in colnames(df_score)){
celltype <- stringr::str_split_fixed(colname, "_", 2)[, 1]
pr <- pr.curve(scores.class0 = df_score[[colname]][df_true[[celltype]] == 0],
scores.class1 = df_score[[colname]][df_true[[celltype]] == 1],
curve = FALSE)
idx <- as.integer(stringr::str_split_fixed(colname, "_", 2)[, 2])
if(idx > 200){
if(idx %% 200 == 0){
idx <- 200
} else{
idx <- idx %% 200
}
}
print(idx)
df_auc[[celltype]][[idx]] <- pr$auc.integral
}
View(df_auc)
?pr.curve
library(fclust)
library(cluster)
library(e1071)
library(foreach)
library(optparse)
library(PRROC)
?pr.curve
x <- rnorm( 1000 );
x
y <- rnorm( 1000, -1 )
pr <- pr.curve( x, y );
print( pr );
df_true <- read.table("../../TrueLabels/true_labels.txt",
header = TRUE)
head(dt_t)
head(dt_true)
head(df_true)
df_anno <- read.table("../../../Statistics/stat.txt", header = TRUE)
##########################################################################
# test
df_score <- read.table("../../../TagCount/TagCount.txt", header = TRUE)
##############################################################################
celltype_list <- unique(df_anno$CellType)
celltype_list
typeof(celltype_list)
celltype_list <- list(unique(df_anno$CellType))
celltype_list
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s", celltype))
}
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s \n", celltype))
}
colnames(df_anno_sub)
colnames(df_anno)
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s \n", celltype))
df_anno_sub <- subset(df_anno_sub, CellType == celltype)
}
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s \n", celltype))
df_anno_sub <- subset(df_anno, CellType == celltype)
}
View(df_anno_sub)
View(df_anno)
View(df_anno_sub)
df_anno_sub$CellType
celltype
celltype_list <- unique(df_anno$CellType)
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s \n", celltype))
df_anno_sub <- subset(df_anno, CellType == celltype)
}
View(df_anno_sub)
df_score_sub <- subset(df_score, select = df_anno_sub$Runs)
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = nrow(df_score))),
c("Runs", "CellType", "AUPR"))
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = ncol(df_score))),
c("Runs", "CellType", "AUPR"))
View(df_auc)
for(colname in colnames(df_score_sub)){
pr <- pr.curve(scores.class0 = df_score_sub[[colname]][df_true[[celltype]] == 1],
scores.class1 = df_score_sub[[colname]][df_true[[celltype]] == 0],
curve = FALSE)
}
library(fclust)
library(cluster)
library(e1071)
library(foreach)
library(optparse)
library(PRROC)
for(colname in colnames(df_score_sub)){
pr <- pr.curve(scores.class0 = df_score_sub[[colname]][df_true[[celltype]] == 1],
scores.class1 = df_score_sub[[colname]][df_true[[celltype]] == 0],
curve = FALSE)
}
round(pr$auc.integral, digits = 3)
colname
for(colname in colnames(df_score_sub)){
pr <- pr.curve(scores.class0 = df_score_sub[[colname]][df_true[[celltype]] == 1],
scores.class1 = df_score_sub[[colname]][df_true[[celltype]] == 0],
curve = FALSE)
aupr <- round(pr$auc.integral, digits = 3)
df_auc <- rbind(df_auc, c("colname", "celltype", aupr))
}
View(df_auc)
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = 0)),
c("Runs", "CellType", "AUPR"))
for(colname in colnames(df_score_sub)){
pr <- pr.curve(scores.class0 = df_score_sub[[colname]][df_true[[celltype]] == 1],
scores.class1 = df_score_sub[[colname]][df_true[[celltype]] == 0],
curve = FALSE)
aupr <- round(pr$auc.integral, digits = 3)
df_auc <- rbind(df_auc, c(colname, celltype, aupr))
}
View(df_auc)
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = 1)),
c("Runs", "CellType", "AUPR"))
View(df_auc)
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = 0)),
c("Runs", "CellType", "AUPR"))
View(df_auc)
colname
celltype
aupr
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = ncol(df_score))),
c("Runs", "CellType", "AUPR"))
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = ncol(df_score))),
c("Runs", "CellType", "AUPR"))
idx <- 1
for(colname in colnames(df_score_sub)){
pr <- pr.curve(scores.class0 = df_score_sub[[colname]][df_true[[celltype]] == 1],
scores.class1 = df_score_sub[[colname]][df_true[[celltype]] == 0],
curve = FALSE)
df_auc[["Runs"]][idx] <- colname
df_auc[["CellType"]][idx] <- celltype
df_auc[["AUPR"]][idx] <- round(pr$auc.integral, digits = 3)
idx <- idx + 1
}
View(df_auc)
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s \n", celltype))
df_anno_sub <- subset(df_anno, CellType == celltype)
df_score_sub <- subset(df_score, select = df_anno_sub$Runs)
for(colname in colnames(df_score_sub)){
pr <- pr.curve(scores.class0 = df_score_sub[[colname]][df_true[[celltype]] == 1],
scores.class1 = df_score_sub[[colname]][df_true[[celltype]] == 0],
curve = FALSE)
df_auc[["Runs"]][idx] <- colname
df_auc[["CellType"]][idx] <- celltype
df_auc[["AUPR"]][idx] <- round(pr$auc.integral, digits = 3)
idx <- idx + 1
}
}
View(df_auc)
df_auc$AUPR
dim(df_auc)
df_auc[["Runs"]][1224] <- colname
View(df_auc)
df_anno$CellType
df_true$H1ESC
df_anno$CellType
df_anno <- stringr::str_replace_all(df_anno$CellType, c("H1-ESC" = "H1ESC"))
celltype_list <- unique(df_anno$CellType)
df_anno <- read.table("../../../Statistics/stat.txt", header = TRUE)
df_anno$CellType <- stringr::str_replace_all(df_anno$CellType, c("H1-ESC" = "H1ESC"))
celltype_list <- unique(df_anno$CellType)
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = ncol(df_score))),
c("Runs", "CellType", "AUPR"))
idx <- 1
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s \n", celltype))
df_anno_sub <- subset(df_anno, CellType == celltype)
df_score_sub <- subset(df_score, select = df_anno_sub$Runs)
for(colname in colnames(df_score_sub)){
pr <- pr.curve(scores.class0 = df_score_sub[[colname]][df_true[[celltype]] == 1],
scores.class1 = df_score_sub[[colname]][df_true[[celltype]] == 0],
curve = FALSE)
df_auc[["Runs"]][idx] <- colname
df_auc[["CellType"]][idx] <- celltype
df_auc[["AUPR"]][idx] <- round(pr$auc.integral, digits = 3)
idx <- idx + 1
}
}
View(df_auc)
df_true <- read.table("../../TrueLabels/true_labels.txt",
header = TRUE)
library(fclust)
library(cluster)
library(e1071)
library(foreach)
library(optparse)
library(PRROC)
df_score <- read.table("../../../TagCount/TagCount.txt", header = TRUE)
df_anno <- read.table("../../../Statistics/stat.txt", header = TRUE)
#df_anno$CellType <- stringr::str_replace_all(df_anno$CellType, c("H1-ESC" = "H1ESC"))
celltype_list <- unique(df_anno$CellType)
celltype_list
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = ncol(df_score))),
c("Runs", "CellType", "AUPR"))
idx <- 1
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s \n", celltype))
df_anno_sub <- subset(df_anno, CellType == celltype)
df_score_sub <- subset(df_score, select = df_anno_sub$Runs)
for(colname in colnames(df_score_sub)){
pr <- pr.curve(scores.class0 = df_score_sub[[colname]][df_true[[celltype]] == 1],
scores.class1 = df_score_sub[[colname]][df_true[[celltype]] == 0],
curve = FALSE)
df_auc[["Runs"]][idx] <- colname
df_auc[["CellType"]][idx] <- celltype
df_auc[["AUPR"]][idx] <- round(pr$auc.integral, digits = 3)
idx <- idx + 1
}
}
head(df_anno)
df_anno <- read.table("../../../Statistics/stat.txt", header = TRUE)
df_anno <- subset(df_anno, Runs %in% colnames(df_score))
#df_anno$CellType <- stringr::str_replace_all(df_anno$CellType, c("H1-ESC" = "H1ESC"))
celltype_list <- unique(df_anno$CellType)
df_anno <- read.table("../../../Statistics/stat.txt", header = TRUE)
df_anno <- subset(df_anno, Runs %in% colnames(df_score))
#df_anno$CellType <- stringr::str_replace_all(df_anno$CellType, c("H1-ESC" = "H1ESC"))
celltype_list <- unique(df_anno$CellType)
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = ncol(df_score))),
c("Runs", "CellType", "AUPR"))
idx <- 1
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s \n", celltype))
df_anno_sub <- subset(df_anno, CellType == celltype)
df_score_sub <- subset(df_score, select = df_anno_sub$Runs)
for(colname in colnames(df_score_sub)){
pr <- pr.curve(scores.class0 = df_score_sub[[colname]][df_true[[celltype]] == 1],
scores.class1 = df_score_sub[[colname]][df_true[[celltype]] == 0],
curve = FALSE)
df_auc[["Runs"]][idx] <- colname
df_auc[["CellType"]][idx] <- celltype
df_auc[["AUPR"]][idx] <- round(pr$auc.integral, digits = 3)
idx <- idx + 1
}
}
df_anno <- read.table("../../../Statistics/stat.txt", header = TRUE)
df_anno <- subset(df_anno, Runs %in% colnames(df_score))
celltype_list <- unique(df_anno$CellType)
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = ncol(df_score))),
c("Runs", "CellType", "AUPR"))
idx <- 1
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s \n", celltype))
df_anno_sub <- subset(df_anno, CellType == celltype)
for(cell in df_anno_sub$Runs){
pr <- pr.curve(scores.class0 = df_score[[cell]][df_true[[celltype]] == 1],
scores.class1 = df_score[[cell]][df_true[[celltype]] == 0],
curve = FALSE)
df_auc[["Runs"]][idx] <- cell
df_auc[["CellType"]][idx] <- celltype
df_auc[["AUPR"]][idx] <- round(pr$auc.integral, digits = 3)
idx <- idx + 1
}
}
View(df_auc)
View(df_auc)
names(celltype_tfs)
celltype_tfs <- c("Fibroblasts_1" = "RUNX2",
"Cardiomyocytes_1" = "Nfe2l2",
"Cardiomyocytes_2" = "GATA4")
names(celltype_tfs)
celltype <- "Fibroblasts_1"
all_celltypes <- c("Cardiomyocytes_1", "Cardiomyocytes_2", "Endothelial_3",
"Macrophages_1", "Neuronal", "Pericytes", "T_cell", "Fibroblasts_1")
other_celltypes <- setdiff(all_celltypes, celltype)
celltype_tfs[[celltype]]
library(fclust)
library(cluster)
library(e1071)
library(foreach)
library(optparse)
library(PRROC)
df_true <- read.table("../../TrueLabels/true_labels.txt",
header = TRUE)
df_score <- read.table("../../../SCALE/SCALE.txt", header = TRUE)
df_score <- read.table("../../../Imputation/SCALE/SCALE.txt", header = TRUE)
df_anno <- read.table("../../../Statistics/stat.txt", header = TRUE)
df_anno <- subset(df_anno, Runs %in% colnames(df_score))
celltype_list <- unique(df_anno$CellType)
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = ncol(df_score))),
c("Runs", "CellType", "AUPR"))
idx <- 1
for(celltype in celltype_list){
message(sprintf("computing AUPR for cell type: %s \n", celltype))
df_anno_sub <- subset(df_anno, CellType == celltype)
for(cell in df_anno_sub$Runs){
pr <- pr.curve(scores.class0 = df_score[[cell]][df_true[[celltype]] == 1],
scores.class1 = df_score[[cell]][df_true[[celltype]] == 0],
curve = FALSE)
df_auc[["Runs"]][idx] <- cell
df_auc[["CellType"]][idx] <- celltype
df_auc[["AUPR"]][idx] <- round(pr$auc.integral, digits = 3)
idx <- idx + 1
}
}
is.na(df_score)
any(is.na(df_score))
View(df_true)
c0 <- df_score[[cell]][df_true[[celltype]] == 1]
c1 <- df_score[[cell]][df_true[[celltype]] == 0]
?pr.curve
typeof(c1)
typeof(c0)
c1
c0
pr <- pr.curve(scores.class0 = c1,
scores.class1 = c0,
curve = FALSE)
is.na(c1)
any(is.na(c1))
any(is.na(c0))
c0
c1 <- as.data.frame((c1))
View(c1)
colnames(df_score)
cell %in% rownames(df_score)
CellType
celltype
View(df_anno_sub)
"SRR5355390" %in% colnames(df_score)
df_score[["SRR5355390"]]
any(is.na(df_score[["SRR5355390"]]))
df_true[[celltype]] == 1
scores.class0 = df_score[[cell]][df_true[[celltype]] == 1]
scores.class1 = df_score[[cell]][df_true[[celltype]] == 0]
rownames(df_score)
scores.class0[[0]]
scores.class0[0]
scores.class0[1]
scores.class0[2]
scores.class0[3]
scores.class0[length(scores.class0)]
df_true[[celltype]] == 1
idx <- df_true[[celltype]] == 1
idx
length(idx)
idx[109418]
df_anno <- read.table("../../../Statistics/stat.txt", header = TRUE)
df_anno <- subset(df_anno, Runs %in% colnames(df_score))
View(df_anno)
celltype_list <- unique(df_anno$CellType)
df_auc <- setNames(data.frame(matrix(ncol = 3,
nrow = ncol(df_score))),
c("Runs", "CellType", "AUPR"))
length(df_score[[cell]])
