library(ggplot2)
library(ggsci)
library(cowplot)
library(gridExtra)
library(dplyr)
library(mclust)
df_tagcount <- read.table("TagCount.txt", header = TRUE, check.names = FALSE)
df_anno <- read.table("../Statistics/stat.txt", header = TRUE)
df_anno$NumofReads <- NULL
df_anno <- subset(df_anno, Runs %in% rownames(df_tagcount))
df_tagcount$Runs <- rownames(df_tagcount)
rownames(df_tagcount) <- NULL
df <- merge(df_tagcount, df_anno, by = "Runs")
ARI_tagcount <- double()
for (i in 1:1){
estimate_cluster <- df[, i+1]
ARI_tagcount <- c(ARI_tagcount, adjustedRandIndex(estimate_cluster, df$CellType))
}
ARI_tagcount <- as.data.frame(ARI_tagcount)
df_BNMF <- read.table("BNMF.txt", header = TRUE, check.names = FALSE)
df_BNMF$Runs <- rownames(df_BNMF)
rownames(df_BNMF) <- NULL
df <- merge(df_BNMF, df_anno, by = "Runs")
ARI_BNMF <- double()
for (i in 1:1){
estimate_cluster <- df[, i+1]
ARI_BNMF <- c(ARI_BNMF, adjustedRandIndex(estimate_cluster, df$CellType))
}
ARI_BNMF <- as.data.frame(ARI_BNMF)
colnames(ARI_tagcount) <- c("ARI")
colnames(ARI_BNMF) <- c("ARI")
ARI_tagcount$Method <- rep("TC", 1)
ARI_BNMF$Method <- rep("atacImpute", 1)
df <- rbind(ARI_tagcount, ARI_BNMF)
write.table(df, "ARI.txt", quote = FALSE, sep = "\t", row.names = FALSE)
meth_cols <- c(
"TC" = "#e41a1c",
"atacImpute" = "#ff7f00"
)
d1 <- df %>%
group_by(Method) %>%
dplyr::summarise(Median = median(ARI))
p <- ggplot(df, aes( x = reorder(Method, -ARI, FUN = median), y = ARI, fill = Method )) +
geom_bar(data = d1, aes(x = reorder(Method, -Median, FUN = median), y = Median), position = "dodge", stat = "identity"
) +
ylim(0, 1) +
scale_fill_manual(values = meth_cols) +
scale_color_manual(values = meth_cols) +
labs(x = "", y = "Adjusted Rand Index") +
theme(
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.line = element_blank(),
legend.key.size = unit(0.5, "cm"),
legend.title = element_blank()
) +
annotate(
"segment",
x = -Inf,
xend = Inf,
y = -Inf,
yend = -Inf,
color = "black"
) +
annotate(
"segment",
x = -Inf,
xend = -Inf,
y = -Inf,
yend = Inf,
color = "black"
)
pdf("ARI.pdf", width = 6, height = 4)
print(p)
dev.off()
?reduceDimension
library(ggplot2)
library(cicero)
library(reshape2)
library(optparse)
?reduceDimension
