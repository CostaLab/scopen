df_list <- vector(mode = "list", length = length(method_list))
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
orders <- levels(with(df, reorder(Method, -AUPR, FUN = mean)))
df.test <- df %>% spread(Method, AUPR)
df.test$Runs <- NULL
df.test$CellType <- NULL
rownames(df.test) <- 1:nrow(df.test)
df.test <- df.test[, orders]
df.test <- as.matrix(df.test)
test.res <- frdAllPairsNemenyiTest(df.test, p.adjust.methods = "BH")
write.xlsx(as.data.frame(test.res$p.value), 'pvalues.xlsx', colNames = TRUE,
rowNames = TRUE)
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA', 'scOpen_SpecificDropout',
'scOpen_NonSpecificDropout')
df_list <- vector(mode = "list", length = length(method_list))
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
orders <- levels(with(df, reorder(Method, -AUPR, FUN = mean)))
df.test <- df %>% spread(Method, AUPR)
df.test$Runs <- NULL
df.test$CellType <- NULL
rownames(df.test) <- 1:nrow(df.test)
df.test <- df.test[, orders]
df.test <- as.matrix(df.test)
test.res <- frdAllPairsNemenyiTest(df.test, p.adjust.methods = "BH")
write.xlsx(as.data.frame(test.res$p.value), 'pvalues.xlsx', colNames = TRUE,
rowNames = TRUE)
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA', 'scOpen_SpecificDropout',
'scOpen_NonSpecificDropout')
df_list <- vector(mode = "list", length = length(method_list))
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
scale_fill_brewer(palette = "Paired") +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
orders <- levels(with(df, reorder(Method, -AUPR, FUN = mean)))
df.test <- df %>% spread(Method, AUPR)
df.test$Runs <- NULL
df.test$CellType <- NULL
rownames(df.test) <- 1:nrow(df.test)
df.test <- df.test[, orders]
df.test <- as.matrix(df.test)
test.res <- frdAllPairsNemenyiTest(df.test, p.adjust.methods = "BH")
write.xlsx(as.data.frame(test.res$p.value), 'pvalues.xlsx', colNames = TRUE,
rowNames = TRUE)
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA', 'scOpen_SpecificDropout',
'scOpen_NonSpecificDropout', 'scOpen_TrueDropout')
df_list <- vector(mode = "list", length = length(method_list))
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
scale_fill_brewer(palette = "Paired") +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
orders <- levels(with(df, reorder(Method, -AUPR, FUN = mean)))
df.test <- df %>% spread(Method, AUPR)
df.test$Runs <- NULL
df.test$CellType <- NULL
rownames(df.test) <- 1:nrow(df.test)
df.test <- df.test[, orders]
df.test <- as.matrix(df.test)
test.res <- frdAllPairsNemenyiTest(df.test, p.adjust.methods = "BH")
write.xlsx(as.data.frame(test.res$p.value), 'pvalues.xlsx', colNames = TRUE,
rowNames = TRUE)
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA', 'scOpen_SpecificDropout',
'scOpen_NonSpecificDropout', 'scOpen_TrueDropout')
df_list <- vector(mode = "list", length = length(method_list))
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
scale_fill_brewer(palette = "Paired") +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
p
head(df)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA', 'scOpen_SpecificDropout',
'scOpen_NonSpecificDropout')
df_list <- vector(mode = "list", length = length(method_list))
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
scale_fill_brewer(palette = "Paired") +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
p
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA', 'scOpen_SpecificDropout',
'scOpen_NonSpecificDropout', 'scOpen_EstimateDropout_KNN')
df_list <- vector(mode = "list", length = length(method_list))
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
scale_fill_brewer(palette = "Paired") +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
orders <- levels(with(df, reorder(Method, -AUPR, FUN = mean)))
df.test <- df %>% spread(Method, AUPR)
df.test$Runs <- NULL
df.test$CellType <- NULL
rownames(df.test) <- 1:nrow(df.test)
df.test <- df.test[, orders]
df.test <- as.matrix(df.test)
test.res <- frdAllPairsNemenyiTest(df.test, p.adjust.methods = "BH")
write.xlsx(as.data.frame(test.res$p.value), 'pvalues.xlsx', colNames = TRUE,
rowNames = TRUE)
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA', 'scOpen_SpecificDropout',
'scOpen_NonSpecificDropout', 'scOpen_EstimateDropout_KNN')
df_list <- vector(mode = "list", length = length(method_list))
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = mean), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
scale_fill_brewer(palette = "Paired") +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
#
# orders <- levels(with(df, reorder(Method, -AUPR, FUN = mean)))
#
# df.test <- df %>% spread(Method, AUPR)
# df.test$Runs <- NULL
# df.test$CellType <- NULL
# rownames(df.test) <- 1:nrow(df.test)
# df.test <- df.test[, orders]
#
# df.test <- as.matrix(df.test)
# test.res <- frdAllPairsNemenyiTest(df.test, p.adjust.methods = "BH")
#
# write.xlsx(as.data.frame(test.res$p.value), 'pvalues.xlsx', colNames = TRUE,
#            rowNames = TRUE)
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA')
df_list <- vector(mode = "list")
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA')
df_list <- vector(mode = "list")
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
for(dropout in c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9)){
df_list[[idx]] <- read.table(sprintf("./AUPR/scOpen_fixed_dropout_%s.txt",
dropout), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA')
df_list <- vector(mode = "list")
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
for(dropout in c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9)){
df_list[[idx]] <- read.table(sprintf("./AUPR/scOpen_fixed_dropout_%s.txt",
dropout), header = TRUE)
df_list[[idx]]$Method <- sprintf("scOpen_fixed_dropout_%s", dropout)
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 30, hjust = 1),
legend.title = element_blank())
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA')
df_list <- vector(mode = "list")
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
for(dropout in c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9)){
df_list[[idx]] <- read.table(sprintf("./AUPR/scOpen_fixed_dropout_%s.txt",
dropout), header = TRUE)
df_list[[idx]]$Method <- sprintf("scOpen_fixed_dropout_%s", dropout)
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 60, hjust = 1),
legend.title = element_blank(),
legend.position = "none")
pdf(file = "AUPR.pdf", height = 8, width = 10)
print(p)
dev.off()
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA')
df_list <- vector(mode = "list")
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
for(dropout in c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9)){
df_list[[idx]] <- read.table(sprintf("./AUPR/scOpen_fixed_dropout_%s.txt",
dropout), header = TRUE)
df_list[[idx]]$Method <- sprintf("scOpen_fixed_dropout_%s", dropout)
idx <- idx + 1
}
for(k in c(1, 5, 10, 15, 20, 25, 30)){
df_list[[idx]] <- read.table(sprintf("./AUPR/KNN_%s.txt",
k), header = TRUE)
df_list[[idx]]$Method <- sprintf("scOpen_KNN_%s", k)
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 60, hjust = 1),
legend.title = element_blank(),
legend.position = "none")
pdf(file = "AUPR.pdf", height = 6, width = 10)
print(p)
dev.off()
library(ggplot2)
library(cowplot)
library(gridExtra)
library(dplyr)
library(tidyr)
library(ComplexHeatmap)
library(reshape2)
library(viridis)
library(PMCMRplus)
library(openxlsx)
method_list <- c('MAGIC', 'scImpute', 'SAVER', 'cisTopic',
'DCA', 'scBFA', 'SCALE', 'Raw', 'PCA')
df_list <- vector(mode = "list")
idx <- 1
for(method in method_list){
df_list[[idx]] <- read.table(sprintf("./AUPR/%s.txt", method), header = TRUE)
df_list[[idx]]$Method <- method
idx <- idx + 1
}
for(dropout in c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9)){
df_list[[idx]] <- read.table(sprintf("./AUPR/scOpen_fixed_dropout_%s.txt",
dropout), header = TRUE)
df_list[[idx]]$Method <- sprintf("scOpen_fixed_dropout_%s", dropout)
idx <- idx + 1
}
for(k in c(1, 5, 10, 15, 20, 25, 30)){
df_list[[idx]] <- read.table(sprintf("./AUPR/KNN_%s.txt",
k), header = TRUE)
df_list[[idx]]$Method <- sprintf("scOpen_KNN_%s", k)
idx <- idx + 1
}
df <- Reduce(rbind, df_list)
cols <- rainbow(length(levels(df$Method)), s=0.8, v=0.9)
df$Method
levels(df$Method)
cols <- rainbow(length(unique(df$Method)), s=0.8, v=0.9)
p <- ggplot(df, aes(x = reorder(Method, -AUPR, FUN = median), y = AUPR)) +
geom_boxplot(aes(fill = Method)) +
scale_fill_manual(values = cols) +
xlab("") + ylab("") +
theme_cowplot() +
theme(axis.text.x = element_text(angle = 60, hjust = 1),
legend.title = element_blank(),
legend.position = "none")
pdf(file = "AUPR.pdf", height = 6, width = 10)
print(p)
dev.off()
